<!DOCTYPE HTML5>

<head>
    <meta charset="utf-8" />
    <title>Gravitarium (Beta 0.1)</title>
    <style>
        * { background-color: #223;}
        canvas { background: #000; display: block; margin: 10 auto; }
    </style>
</head>
<body>
    <canvas id="scene" width="2000" height="1200"></canvas>

    <script>
        const canvas = document.getElementById("scene");
        const context = canvas.getContext("2d");

        function Planet(mass, color, x, y, dx, dy, ax, ay)
        {
            this.mass = mass;
            this.color = color;
            this.x = x;
            this.y = y;
            this.dx = dx;
            this.dy = dy;
            this.ax = ax;
            this.ay = ay;
        }
            
        //Planet Earth
        let earth = new Planet(40000, "#33a", 800, 600, 1, -10, 0, 0);

        //Planet Mars
        let mars = new Planet(50000, "#a33", 1000, 600, 2, 10, 0, 0);

        let mercury = new Planet(30000, "#a93", 1000, 600, 2, -2, 0, 0);


        
        function drawPlanet(planet)
        {
            planet.dx += planet.ax;
            planet.dy += planet.ay;
            planet.x += planet.dx;
            planet.y += planet.dy;

            context.beginPath();
            context.arc(planet.x, planet.y, 15, 0, 6.29);
            context.fillStyle = planet.color;
            context.fill();
            context.closePath();
        } 

        function drawEarth(planet)
        {
            planet.dx += planet.ax;
            planet.dy += planet.ay;
            planet.x += planet.dx;
            planet.y += planet.dy;

            context.beginPath();
            context.arc(planet.x, planet.y, 15, 0, 6.29);
            context.fillStyle = planet.color;
            context.fill();
            context.closePath();
        }

        function drawMars(planet)
        {
            planet.dx += planet.ax;
            planet.dy += planet.ay;
            planet.x += planet.dx;
            planet.y += planet.dy;

            context.beginPath();
            context.arc(planet.x, planet.y, 15, 0, 6.29);
            context.fillStyle = planet.color;
            context.fill();
            context.closePath();
        }


        //main loop
        function update()
        {
            sqDistance = (earth.x - mars.x)*(earth.x - mars.x) + (earth.y - mars.y)*(earth.y - mars.y);

            earth.ax = mars.mass/sqDistance*(mars.x - earth.x)/Math.sqrt(sqDistance);
            earth.ay = mars.mass/sqDistance*(mars.y - earth.y)/Math.sqrt(sqDistance);
            earth.ax += mercury.mass/sqDistance*(mercury.x - earth.x)/Math.sqrt(sqDistance);
            earth.ay += mercury.mass/sqDistance*(mercury.y - earth.y)/Math.sqrt(sqDistance);

            mars.ax = -earth.mass/sqDistance*(mars.x - earth.x)/Math.sqrt(sqDistance);
            mars.ay = -earth.mass/sqDistance*(mars.y - earth.y)/Math.sqrt(sqDistance);
            mars.ax += mercury.mass/sqDistance*(mercury.x - mars.x)/Math.sqrt(sqDistance);
            mars.ay += mercury.mass/sqDistance*(mercury.y - mars.y)/Math.sqrt(sqDistance);

            console.log(earth.ay, earth.x, earth.y);

            context.clearRect(0, 0, canvas.width, canvas.height);
            drawPlanet(mars);
            drawPlanet(earth);
            drawPlanet(mercury);
        }

        setInterval(update, 40);
    </script>

</body>